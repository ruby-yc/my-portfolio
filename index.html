<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>YuChen Dong (Ruby)</title>
  <link rel="stylesheet" href="style.css" />
  <style>


    /* 防止 body 對整體滾動有干擾 */
    html, body {
      margin: 0;
      padding: 0;
      overflow-x: hidden;
    }
  </style>
</head>
<body>

  <!--  頁首 -->
  <div class="header" id="header">
    <img src="images/1000002466 (1600×500).png" alt="background image">
    <div class="header-text" id="headerText">
      <h2 class="header-title">YuChen (Ruby) Dong</h2>
      <h3 class="header-subtitle">
        Aspiring Software Engineer exploring where aesthetics meet algorithms.
      </h3>
    </div>
  </div>

  <!--  導覽列 -->
  <div class="tabs-wrapper" id="tabsWrapper">
    <div class="tabs">
      <div class="tab active" onclick="loadPage('intro.html', this)">Intro</div>
      <div class="tab" onclick="loadPage('project.html', this)">Projects</div>
      <div class="tab" onclick="loadPage('skill.html', this)">Skills</div>
      <div class="tab" onclick="loadPage('resume.html', this)">Resume</div>
      <div class="tab" onclick="loadPage('other.html', this)">Other</div>
      <div class="tab" onclick="loadPage('contact.html', this)">Contact</div>
    </div>
  </div>

  <!--  iframe 內容區 -->
  <iframe id="contentFrame" src="intro.html" scrolling="no"></iframe>

  <script>
    /* ----------------------------
        強制回頂部設定
    ----------------------------- */
    if ('scrollRestoration' in history) {
      try { history.scrollRestoration = 'manual'; } catch (e) {}
    }

    function forceScrollTop() {
      window.scrollTo(0, 0);
      document.documentElement.scrollTop = 0;
      document.body.scrollTop = 0;
      setTimeout(() => { window.scrollTo(0, 0); }, 100);
      setTimeout(() => { window.scrollTo(0, 0); }, 400);
    }

    window.addEventListener('load', forceScrollTop);
    window.addEventListener('pageshow', () => forceScrollTop());

    if (location.hash) {
      history.replaceState(null, '', location.pathname + location.search);
      forceScrollTop();
    }

    /* ----------------------------
        iframe 自動高度設定
    ----------------------------- */
    const header = document.getElementById('header');
    const tabsWrapper = document.getElementById('tabsWrapper');
    const iframe = document.getElementById('contentFrame');

    // 滾動時漸隱效果
    window.addEventListener('scroll', () => {
      const scrollY = window.scrollY;
      const opacity = Math.max(0, 1 - scrollY / 150);
      header.style.opacity = opacity;
      tabsWrapper.style.opacity = opacity;
    });

    // 切換分頁
    function loadPage(pageUrl, tabElement) {
      forceScrollTop();
      iframe.src = pageUrl;
      document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
      tabElement.classList.add('active');
    }

    // 自動調整 iframe 高度
    function adjustIframeHeight() {
      try {
        const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
        const body = iframeDoc.body;
        const html = iframeDoc.documentElement;

        const height = Math.max(
          body.scrollHeight,
          body.offsetHeight,
          html.clientHeight,
          html.scrollHeight,
          html.offsetHeight
        );

        iframe.style.height = (height + 10) + 'px';
        console.log(' iframe 高度自動調整:', height + 'px');
      } catch (e) {
        console.error(' iframe 高度偵測失敗:', e);
        iframe.style.height = '2000px';
      }
    }

    // 載入子頁後多次校正高度
    iframe.onload = function () {
      setTimeout(adjustIframeHeight, 200);
      setTimeout(adjustIframeHeight, 500);
      setTimeout(adjustIframeHeight, 1000);
      setTimeout(adjustIframeHeight, 1500);
    };

    window.addEventListener('resize', adjustIframeHeight);
  </script>

</body>
</html>
